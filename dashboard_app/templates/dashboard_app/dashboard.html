{% extends 'common_app/base.html' %}

{% load static %}

{% block main_area %}

<div class="pagetitle">
    <h1>Dashboard</h1>
    <nav>
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="/">메인</a></li>
            <li class="breadcrumb-item active">Dashboard</li>
        </ol>
    </nav>
</div>

<h3>안녕하세요 {{ request.user.name }} 님</h3>

<section class="section dashboard">
    <div class="row">
        <div class="col-lg-8">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">
                        수업 일정 <span>| Today</span>
                    </h5>
                    <div id="calendar"></div>
                </div>
            </div>
        </div>

        <div class="col-lg-4">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">
                        수업 일정 <span>| Today</span>
                    </h5>

                    <div class="activity">
                        <div class="activity-item d-flex">
                            <div class="activite-label">12:30</div>
                            <i class="bi bi-circle-fill activity-badge text-success align-self-start"></i>
                            <div class="activity-content">
                                이현주 님 <a href="#" class="fw-bold text-dark">수업</a>
                            </div>
                        </div>

                        <div class="activity-item d-flex">
                            <div class="activite-label">12:30</div>
                            <i class="bi bi-circle-fill activity-badge text-success align-self-start"></i>
                            <div class="activity-content">
                                이현주 님 <a href="#" class="fw-bold text-dark">수업</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/80x15.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/">Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License</a>.

<script>
    document.addEventListener('DOMContentLoaded', function()    {

    var calendarEl = document.getElementById('calendar');
    var calendar = new FullCalendar.Calendar(calendarEl, {
        schedulerLicenseKey: 'CC-Attribution-NonCommercial-NoDerivatives',

        selectable: true,

        timeZone: 'Asia/Seoul',
        locale: 'ko',
        firstDay: 1,
        allDaySlot: false,
        slotMinTime: "06:00:00",
        contentHeight:"auto",
        hiddenDays: [ 0 ],

        slotLabelFormat: {
            hour: '2-digit',
            omitZeroMinute: false,
            hour12: false,
            meridiem: 'short',
        },

        headerToolbar: {
            start: 'dayGridMonth,timeGridWeek,timeGridDay',
            center: 'title',
            end: 'today prev,next'
        },

        events: [

        ],
        eventTimeFormat: {
            hour: "2-digit",
            minute: "2-digit",
            meridiem: false,
            hour12: false
        },

//        initialView: 'timeGridWeek',

//      ------------------ Vertical Resource View 를 위한 설정
        initialView: 'resourceTimeGridDay',
        resources: [
            {% for studio in studios %}
                {% for teacher in studio.teachers.all %}
                    {
                        id: '{{ studio.id }}' + ':' + '{{ teacher.id }}',
                        title: '{{ studio.name }}' + ':' + '{{ teacher.name }}',
                    },
                {% endfor %}
            {% endfor %}
        ],

//      ----------------------------------------------------

        dateClick: function(info) {
            document.getElementById("id_lesson_time").value = ""

            const dtArray = info.dateStr.split("T");
            document.getElementById("datePicker").value = dtArray[0];
            document.getElementById("id_lesson_date").value = dtArray[0];

            if (typeof dtArray[1] !== 'undefined') {
                document.getElementById("id_lesson_time").value = dtArray[1];
            }

            document.getElementById("createButton").click();

        }
    });
    calendar.render();
});
</script>

{% endblock %}